{% set marquee        = theme.settings.get('marquee', true) %}
{% set marqueetext    = theme.settings.get('marqueetext', '') %}
{% set marqueecolortext = theme.settings.get('marqueecolortext', '') %}
{% set marqueecolorback = theme.settings.get('marqueecolorback', '') %}
{% set marqueeurl     = theme.settings.get('marqueeurl', '') %}

{% if marquee and marqueetext %}
  <div id="custom-marquee" class="marquee" style="background-color: {{ marqueecolorback }}; position: relative; z-index: 50;">
    <button class="close-button" style="position: absolute; top: 5px; right: 10px; background: none; border: none; font-size: 20px; cursor: pointer;" onclick="document.getElementById('custom-marquee').style.display='none'">×</button>
    <ul class="marquee__content" style="color: {{ marqueecolortext }}; margin: 0; padding: 10px;">
      {% for i in 1..10 %}
        <li class="text-md " style="display: inline-block; margin-right: 20px;">
          {% if marqueeurl %}
            <a href="{{ marqueeurl }}" style="color: {{ marqueecolortext }}; text-decoration: underline;">
              {{ marqueetext }}
            </a>
          {% else %}
            {{ marqueetext }}
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>
{% endif %}


<header class="store-header">

  <!-- Main Navigation -->
  <div class="main-nav-container flex items-center justify-between relative">
    <!-- Logo + Menu -->
    <div class="flex items-center gap-6">
      <!-- Mobile Menu -->
      <a class="lg:hidden mburger mburger--collapse" href="#mobile-menu" aria-label="Open menu">
        <i class="sicon-menu text-primary text-2xl"></i>
      </a>

      <!-- Logo -->
      <a class="navbar-brand" href="{{ store.url }}">
        {% if theme.settings.get('show_custom_logos') and theme.settings.get('logo_top') %}
          <img src="{{ theme.settings.get('logo_top') }}" loading="eager" alt="{{ store.name }} logo">
        {% else %}
          <img src="{{ store.logo }}" width="100%" height="100%" loading="eager" alt="{{ store.name }} logo">
        {% endif %}
        {% if is_page('index') %}
          <h1 class="sr-only">{{ store.name }}</h1>
        {% else %}
          <h2 class="sr-only">{{ store.name }}</h2>
        {% endif %}
      </a>

      <!-- Main Menu Desktop -->
      <div class="hidden lg:flex gap-4">
        <custom-main-menu></custom-main-menu>
      </div>
    </div>

    <!-- Right Side -->
    <div class="flex items-center gap-4">
      {% if store.settings.is_multilingual or store.settings.currencies_enabled %}
        <button type="button" onclick="salla.event.dispatch('localization::open')" class="btn--rounded-gray text-sm flex items-center gap-1 px-2">
          <i class="sicon-world"></i>
        </button>
        <salla-localization-modal language="ar" currency="SAR" class="hydrated"></salla-localization-modal>
      {% endif %}

      {% if user.type == 'user' %}
        <salla-user-menu avatar-only show-header></salla-user-menu>
      {% else %}
        <button class="header-btn" aria-label="user-icon" onclick="salla.event.dispatch('login::open')">
          <i class="header-btn__icon sicon-user"></i>
        </button>
      {% endif %}

      <salla-cart-summary>
        <i slot="icon" class="header-btn__icon sicon-shopping-basket"></i>
      </salla-cart-summary>

      <!-- Search -->
      <button id="search-toggle" class="search-icon">
        <i class="sicon-search"></i>
      </button>
      <div id="search-box" class="search-box hidden">
        <salla-search inline="" oval="" height="36" class="hydrated"></salla-search>
      </div>
    </div>
  </div>
</header>


<style>
  /* الهيدر */
  .store-header {
    position: sticky;
    top: 10px;
    z-index: 1000;
    height: 90px;
    line-height: 90px;
    transition: all 0.3s ease;
    border-radius: 45px;
    width: 90%;
    margin: 15px auto 0;
    padding: 0 25px;

    /* Glass Effect */
    background: rgba(255, 255, 255, 0.4); 
    backdrop-filter: blur(15px) saturate(150%);
    -webkit-backdrop-filter: blur(15px) saturate(150%);
    box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    border: 1px solid rgba(255, 255, 255, 0.3);
  }

  /* عند التمرير */
  .store-header.expand {
    height: 110px;
    line-height: 110px;
    border-radius: 55px;
    width: 85%;
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
  }

  /* الماركيه */
  #custom-marquee {
    position: relative;
    z-index: 900;
    width: 100%;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const header = document.querySelector('.store-header');

    window.addEventListener('scroll', function () {
      if (window.scrollY > 0) {
        header.classList.add('expand');
      } else {
        header.classList.remove('expand');
      }
    });
  });
</script>
