{% set marquee = theme.settings.get('marquee', true) %}
{% set marqueetext = theme.settings.get('marqueetext', '') %}
{% set marqueecolortext = theme.settings.get('marqueecolortext', ) %}
{% set marqueecolorback = theme.settings.get('marqueecolorback', ) %}
{% set marqueeurl = theme.settings.get('marqueeurl', '') %}

{% if marquee and marqueetext %}
  <div id="custom-marquee" class="marquee" style="background-color: {{ marqueecolorback }}; position: relative; z-index: 50;">
    <button class="close-button" style="position: absolute; top: 5px; right: 10px; background: none; border: none; font-size: 20px; cursor: pointer;" onclick="document.getElementById('custom-marquee').style.display='none'">×</button>
    <ul class="marquee__content" style="color: {{ marqueecolortext }}; margin: 0; padding: 10px;">
      {% for i in 1..10 %}
        <li class="text-md " style="display: inline-block; margin-right: 20px;">
          {% if marqueeurl %}
            <a href="{{ marqueeurl }}" style="color: {{ marqueecolortext }}; text-decoration: underline;">
              {{ marqueetext }}
            </a>
          {% else %}
            {{ marqueetext }}
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>

{% endif %}


{% set show_loding  = theme.settings.get('show_loding', true) %}
{% set colorpage    = theme.settings.get('lodingitem4', true) %}
{% set width        = theme.settings.get('loadingitem1', true) %}
{% set height       = theme.settings.get('loadingitem2', true) %}
{% set image        = theme.settings.get('lodingitem3', true) %}
{% set effect       = theme.settings.get('loadingeffect', true) %}

{% if show_loding %}
<div id="loading" class="loading-screen bg-opacity-80 flex items-center justify-center h-screen"
     style="background-color: {{ colorpage }};">
     <img 
     {% if image %}
       src="{{ image }}"
     {% else %}
       src="{{ store.logo }}"
     {% endif %} 
      alt="Loading..."  class="logo-{{ effect }}">
</div>
{% endif %}





<header class="store-header bg-white shadow-sm relative">

  <!-- Main Navigation -->
  <div id="mainnav" class="main-nav-container home-header fixed-pinned animated fixed-header" style="position: absolute; width: 100%; z-index: 102; height: 60px;">
    <div class="container flex items-center justify-between py-3 relative">

      <!-- Logo & Main Menu -->
      <div class="flex items-center gap-6">
        <!-- Mobile Menu Button -->
        <a class="lg:hidden mburger mburger--collapse" href="#mobile-menu" aria-label="Open menu">
          <i class="sicon-menu text-primary text-2xl"></i>
        </a>

        <!-- Logo -->
        <a class="navbar-brand" href="{{ store.url }}">
          {% if theme.settings.get('show_custom_logos') and theme.settings.get('logo_top') %}
            <img src="{{ theme.settings.get('logo_top') }}" loading="eager" alt="{{ store.name }} logo">
          {% else %}
            <img src="{{ store.logo }}" width="100%" height="100%" loading="eager" alt="{{ store.name }} logo">
          {% endif %}
          {% if is_page('index') %}
            <h1 class="sr-only">{{ store.name }}</h1>
          {% else %}
            <h2 class="sr-only">{{ store.name }}</h2>
          {% endif %}
        </a>

        <!-- Main Menu Desktop -->
        <div class="hidden lg:flex gap-4">
          <custom-main-menu></custom-main-menu>
        </div>
      </div>

      <!-- Right Side Header Buttons -->
      <div class="flex items-center gap-4">

        <!-- Localization & Currency -->
        {% if store.settings.is_multilingual or store.settings.currencies_enabled %}
          <button type="button" onclick="salla.event.dispatch('localization::open')" class="btn--rounded-gray text-sm flex items-center gap-1 px-2">
            <i class="sicon-world"></i>
          </button>
          <salla-localization-modal language="ar" currency="SAR" class="hydrated"></salla-localization-modal>
        {% endif %}

        <!-- User Menu -->
        {% if user.type == 'user' %}
          <salla-user-menu avatar-only show-header></salla-user-menu>
        {% else %}
          <button class="header-btn" aria-label="user-icon" onclick="salla.event.dispatch('login::open')">
            <i class="header-btn__icon sicon-user"></i>
          </button>
        {% endif %}

        <!-- Cart -->
        <salla-cart-summary>
          <i slot="icon" class="header-btn__icon sicon-shopping-basket"></i>
        </salla-cart-summary>

        <!-- Search -->
        <button id="search-toggle" class="search-icon">
          <i class="sicon-search"></i>
        </button>
        <div id="search-box" class="search-box hidden">
          <salla-search inline="" oval="" height="36" class="hydrated">
            <div class="s-search-modal">
              <div class="s-search-container s-search-inline">
                <div class="s-search-input-wrapper">
                  <span class="s-search-icon-wrap">
                    <span class="s-search-icon">
                      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
                        <title>search</title>
                        <path d="M30.276 28.391l-7.576-7.576c1.644-2.053 2.633-4.652 2.633-7.481 0-6.616-5.384-12-12-12s-12 5.384-12 12 5.384 12 12 12c2.829 0 5.428-0.989 7.481-2.633l7.576 7.576c0.26 0.26 0.601 0.391 0.943 0.391s0.683-0.131 0.943-0.391c0.521-0.521 0.521-1.364 0-1.885zM13.333 22.667c-5.147 0-9.333-4.187-9.333-9.333s4.187-9.333 9.333-9.333 9.333 4.187 9.333 9.333-4.187 9.333-9.333 9.333z"></path>
                      </svg>
                    </span>
                  </span>
                  <input type="search" enterkeyhint="search" autocomplete="off" class="s-search-input" placeholder="ادخل كلمة البحث" style="height: 36px; border-radius: 18px;">
                </div>
                <div class="s-search-results">
                  <p class="s-search-no-results-placeholder" style="display: none;">لا توجد نتائج</p>
                </div>
              </div>
            </div>
          </salla-search>
        </div>

      </div>
    </div>
  </div>

  <!-- Optional Store Scope Component -->
  {% if store.scope %}
    <salla-scopes selection="{{ store.scope.display_as == 'popup' ? 'mandatory' : 'optional' }}"></salla-scopes>
  {% endif %}

</header>




{% if store.scope %}
    <salla-scopes selection="{{ store.scope.display_as == 'popup' ? 'mandatory' : 'optional' }}"></salla-scopes>
{% endif %}


<script>
  document.addEventListener('DOMContentLoaded', function () {
    const searchToggle = document.getElementById('search-toggle');
    const searchBox = document.getElementById('search-box');

    searchToggle.addEventListener('click', function () {
      searchBox.classList.toggle('hidden'); // يفتح ويغلق صندوق البحث
      const input = searchBox.querySelector('input');
      if (!searchBox.classList.contains('hidden') && input) {
        input.focus(); // يضع المؤشر مباشرة في حقل البحث
      }
    });
  });
</script>